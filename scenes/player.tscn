[gd_scene load_steps=49 format=3 uid="uid://b72fdcrlypc86"]

[ext_resource type="AudioStream" uid="uid://bnaa47d42yp8e" path="res://sources/SFX/Player/Land/Player_Land_Dirt_v1.ogg" id="2_6y5cm"]
[ext_resource type="Script" path="res://scenes/player_audio_manager.gd" id="2_mirnq"]
[ext_resource type="Texture2D" uid="uid://cru6ng4m43trc" path="res://sources/knight.png" id="2_vsk4g"]
[ext_resource type="AudioStream" uid="uid://r1aaf8460rr5" path="res://sources/SFX/Player/Footsteps/Player_Step_Dirt_v1.ogg" id="3_g578f"]
[ext_resource type="AudioStream" uid="uid://c24y4yki1tema" path="res://sources/SFX/Player/Land/Player_Land_Dirt_v2.ogg" id="3_qf3p5"]
[ext_resource type="AudioStream" uid="uid://dcao8jccun365" path="res://sources/SFX/Player/Footsteps/Player_Step_Dirt_v2.ogg" id="4_gv24y"]
[ext_resource type="AudioStream" uid="uid://dqslhr5dd5qxh" path="res://sources/SFX/Player/Land/Player_Land_Dirt_v3.ogg" id="4_neaa8"]
[ext_resource type="AudioStream" uid="uid://o4ffk6q650cs" path="res://sources/SFX/Player/Footsteps/Player_Step_Dirt_v3.ogg" id="5_bmnyq"]
[ext_resource type="AudioStream" uid="uid://dxxg123ip6nxw" path="res://sources/SFX/Player/Land/Player_Land_Dirt_v4.ogg" id="5_dxs5g"]
[ext_resource type="AudioStream" uid="uid://b0oe3amg5u5dl" path="res://sources/SFX/Player/Footsteps/Player_Step_Dirt_v4.ogg" id="6_buq6l"]
[ext_resource type="AudioStream" uid="uid://bjs5urw8plx16" path="res://sources/SFX/Player/Land/Player_Land_Dirt_v5.ogg" id="6_dkq7s"]
[ext_resource type="AudioStream" uid="uid://daowdog3jqqxk" path="res://sources/SFX/Player/Land/Player_Land_Wood_v1.ogg" id="7_36ik4"]
[ext_resource type="AudioStream" uid="uid://co0dfxjps7u72" path="res://sources/SFX/Player/Land/Player_Land_Wood_v2.ogg" id="8_g44vc"]
[ext_resource type="AudioStream" uid="uid://blxt2lvhf5eor" path="res://sources/SFX/Player/Land/Player_Land_Wood_v3.ogg" id="9_ninnl"]
[ext_resource type="AudioStream" uid="uid://cbc15roovqh6u" path="res://sources/SFX/Player/Land/Player_Land_Wood_v4.ogg" id="10_nfwmg"]
[ext_resource type="AudioStream" uid="uid://davpukhd7lpdu" path="res://sources/SFX/Player/Land/Player_Land_Wood_v5.ogg" id="11_b1crm"]
[ext_resource type="AudioStream" uid="uid://c4lglij44jpa3" path="res://sources/SFX/Player/Footsteps/Player_Step_Wood_v1.ogg" id="16_of0t6"]
[ext_resource type="AudioStream" uid="uid://8dxnvvbk73tb" path="res://sources/SFX/Player/Footsteps/Player_Step_Wood_v2.ogg" id="17_lafu5"]
[ext_resource type="AudioStream" uid="uid://pa4wsbp0s7a5" path="res://sources/SFX/Player/Footsteps/Player_Step_Wood_v3.ogg" id="18_aku03"]
[ext_resource type="AudioStream" uid="uid://crgol0gbthh66" path="res://sources/SFX/Player/Footsteps/Player_Step_Wood_v4.ogg" id="19_os0ps"]
[ext_resource type="AudioStream" uid="uid://dt5u6t6lt7v52" path="res://sources/SFX/Player/Footsteps/Player_Step_Wood_v5.ogg" id="20_0y6ww"]
[ext_resource type="AudioStream" uid="uid://cfsue0llwws2" path="res://sources/SFX/Player/Jump/Player_Jump_Wood_v1.ogg" id="21_amrcq"]
[ext_resource type="AudioStream" uid="uid://dhxpi3u3x1iab" path="res://sources/SFX/Player/Jump/Player_Jump_Wood_v2.ogg" id="22_wdjx7"]
[ext_resource type="AudioStream" uid="uid://cp00vgp52m5hh" path="res://sources/SFX/Player/Jump/Player_Jump_Wood_v3.ogg" id="23_iaby8"]
[ext_resource type="AudioStream" uid="uid://c8tnpsk3i7aoj" path="res://sources/SFX/Player/Jump/Player_Jump_Wood_v4.ogg" id="24_pda3e"]
[ext_resource type="AudioStream" uid="uid://bcjdnk68e6s5i" path="res://sources/SFX/Player/Jump/Player_Jump_Wood_v5.ogg" id="25_sxdn3"]

[sub_resource type="GDScript" id="GDScript_xs5un"]
script/source = "class_name Player extends CharacterBody2D

@export var MAX_SPEED: int = 200
@export var JUMP_VELOCITY: int = -300.0
@export var ACCELERATION: int = 1500
@export_range(0, 10, 0.1, \"or_greater\") var DECELERATION_TIME: float = 0.2

var deceleration: float = MAX_SPEED / DECELERATION_TIME

func _physics_process(delta: float) -> void:
	apply_gravity(delta)
	
	apply_player_jump()
	
	apply_horizontal_movement(delta)

	move_and_slide()


func apply_gravity(delta: float):
	# Add the apply_gravity.
	if not is_on_floor():
		velocity += get_gravity() * delta

func apply_player_jump():
	if Input.is_action_just_pressed(\"jump\") and is_on_floor():
		velocity.y = JUMP_VELOCITY

func apply_horizontal_movement(delta: float):
	# Get the input direction and handle the movement/deceleration.
	# As good practice, you should replace UI actions with custom gameplay actions.
	var direction := Input.get_axis(\"left\", \"right\")
	
	if direction: # Direction button active
		# Accelerate towards the target speed
		velocity.x = move_toward(velocity.x, direction * MAX_SPEED, ACCELERATION * delta)

	else: # Direction button inactive
		# Decelerate towards zero speed
		print(deceleration)
		velocity.x = move_toward(velocity.x, 0, deceleration * delta)
	
	
"

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_0flpv"]
radius = 5.0
height = 18.0

[sub_resource type="Animation" id="Animation_ba674"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimationPlayer/AnimatedSprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0]
}

[sub_resource type="Animation" id="Animation_ap55u"]
resource_name = "idle"
length = 0.4
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimationPlayer/AnimatedSprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [0, 1, 2, 3]
}

[sub_resource type="Animation" id="Animation_6jg5e"]
resource_name = "jumping"
tracks/0/type = "method"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player Audio Manager/Jumping SFX")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [0.0],
"method": &"play"
}]
}

[sub_resource type="Animation" id="Animation_2gj0e"]
resource_name = "walk"
tracks/0/type = "method"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player Audio Manager/Footstep SFX")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0.233333, 0.7),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [0.0],
"method": &"play"
}, {
"args": [0.0],
"method": &"play"
}]
}

[sub_resource type="Animation" id="Animation_jpuhp"]
resource_name = "land"
tracks/0/type = "method"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player Audio Manager/Landing SFX")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [0.0],
"method": &"play"
}]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_pucqf"]
_data = {
"RESET": SubResource("Animation_ba674"),
"idle": SubResource("Animation_ap55u"),
"jump": SubResource("Animation_6jg5e"),
"land": SubResource("Animation_jpuhp"),
"walk": SubResource("Animation_2gj0e")
}

[sub_resource type="AtlasTexture" id="AtlasTexture_ff4ej"]
atlas = ExtResource("2_vsk4g")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_7ksxf"]
atlas = ExtResource("2_vsk4g")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_bimj1"]
atlas = ExtResource("2_vsk4g")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_4gxpx"]
atlas = ExtResource("2_vsk4g")
region = Rect2(96, 0, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_6b3tj"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ff4ej")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_7ksxf")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_bimj1")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_4gxpx")
}],
"loop": true,
"name": &"default",
"speed": 10.0
}]

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_kgei5"]
random_pitch = 1.1
streams_count = 5
stream_0/stream = ExtResource("2_6y5cm")
stream_1/stream = ExtResource("3_qf3p5")
stream_2/stream = ExtResource("4_neaa8")
stream_3/stream = ExtResource("5_dxs5g")
stream_4/stream = ExtResource("6_dkq7s")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_1fg42"]
random_pitch = 1.1
streams_count = 5
stream_0/stream = ExtResource("7_36ik4")
stream_1/stream = ExtResource("8_g44vc")
stream_2/stream = ExtResource("9_ninnl")
stream_3/stream = ExtResource("10_nfwmg")
stream_4/stream = ExtResource("11_b1crm")

[sub_resource type="AudioStreamInteractive" id="AudioStreamInteractive_iwi2n"]
clip_count = 2
clip_0/name = &"dirt"
clip_0/stream = SubResource("AudioStreamRandomizer_kgei5")
clip_0/auto_advance = 0
clip_1/name = &"wood"
clip_1/stream = SubResource("AudioStreamRandomizer_1fg42")
clip_1/auto_advance = 0

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_p7k8r"]
random_pitch = 1.1
streams_count = 5
stream_0/stream = ExtResource("3_g578f")
stream_1/stream = ExtResource("4_gv24y")
stream_2/stream = ExtResource("5_bmnyq")
stream_3/stream = ExtResource("6_buq6l")
stream_4/stream = ExtResource("6_dkq7s")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_ah62t"]
random_pitch = 1.1
streams_count = 5
stream_0/stream = ExtResource("16_of0t6")
stream_1/stream = ExtResource("17_lafu5")
stream_2/stream = ExtResource("18_aku03")
stream_3/stream = ExtResource("19_os0ps")
stream_4/stream = ExtResource("20_0y6ww")

[sub_resource type="AudioStreamInteractive" id="AudioStreamInteractive_nn5sh"]
clip_count = 2
clip_0/name = &"dirt"
clip_0/stream = SubResource("AudioStreamRandomizer_p7k8r")
clip_0/auto_advance = 0
clip_1/name = &"wood"
clip_1/stream = SubResource("AudioStreamRandomizer_ah62t")
clip_1/auto_advance = 0

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_i87wi"]
streams_count = 1

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_wdp4j"]
random_pitch = 1.1
streams_count = 5
stream_0/stream = ExtResource("21_amrcq")
stream_1/stream = ExtResource("22_wdjx7")
stream_2/stream = ExtResource("23_iaby8")
stream_3/stream = ExtResource("24_pda3e")
stream_4/stream = ExtResource("25_sxdn3")

[sub_resource type="AudioStreamInteractive" id="AudioStreamInteractive_oevhm"]
clip_count = 2
clip_0/name = &"TODO dirt"
clip_0/stream = SubResource("AudioStreamRandomizer_i87wi")
clip_0/auto_advance = 0
clip_1/name = &"wood"
clip_1/stream = SubResource("AudioStreamRandomizer_wdp4j")
clip_1/auto_advance = 0

[node name="Player" type="CharacterBody2D"]
position = Vector2(584, 373)
script = SubResource("GDScript_xs5un")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(1, -9)
shape = SubResource("CapsuleShape2D_0flpv")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_pucqf")
}
autoplay = "idle"

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="AnimationPlayer"]
position = Vector2(585, 361)
sprite_frames = SubResource("SpriteFrames_6b3tj")

[node name="Player Audio Manager" type="Node" parent="."]
script = ExtResource("2_mirnq")

[node name="AudioListener2D" type="AudioListener2D" parent="Player Audio Manager"]
position = Vector2(584, 373)

[node name="Landing SFX" type="AudioStreamPlayer2D" parent="Player Audio Manager"]
position = Vector2(584, 373)
stream = SubResource("AudioStreamInteractive_iwi2n")
bus = &"SFX"

[node name="Footstep SFX" type="AudioStreamPlayer2D" parent="Player Audio Manager"]
position = Vector2(584, 373)
stream = SubResource("AudioStreamInteractive_nn5sh")
bus = &"SFX"

[node name="Jumping SFX" type="AudioStreamPlayer2D" parent="Player Audio Manager"]
stream = SubResource("AudioStreamInteractive_oevhm")
bus = &"SFX"
